# Swap Ctrl-B for Ctrl-W
set-option -g prefix C-w
unbind-key C-b
bind-key C-w send-prefix

# Make Ctrl-W twice switch windows
bind-key C-w last-window

# Don't wait for escape codes, just GO
set -s escape-time 0

# Pane display
bind C-r display-panes
set-option -g display-panes-time 2000

# VI keys for moving between panes and windows
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind C-h select-pane -L
bind C-j select-pane -D
bind C-k select-pane -U
bind C-l select-pane -R
bind-key -n M-h select-pane -L
bind-key -n M-j select-pane -D
bind-key -n M-k select-pane -U
bind-key -n M-l select-pane -R

# Pane resizing, EDSF
bind C-s resize-pane -L 4
bind C-f resize-pane -R 4
bind C-d resize-pane -D 4
bind C-e resize-pane -U 4

# Binding to rkload the config
bind r source-file ~/.config/tmux/tmux.conf

# Make the status bar white on blue
set-option -g status-bg red
set-option -g status-fg white

# Logical Window Splitting (- and | to split vertically and horizontally)
unbind %
bind | split-window -h
bind - split-window -v

# Set Pane Border Colors
#set-option -g pane-active-border-style bg=black,fg=blue
#set-option -g pane-border-style bg=black,fg=white
set -g pane-border-style 'fg=colour242 bg=colour234'
set -g pane-active-border-style 'fg=colour67 bg=colour234'
set -g pane-border-format ' [#P] <#{pane_current_command}> @ #{pane_current_path} #{?window_zoomed_flag,#[fg=colour228]Z#[fg=colour77] ,}'
set -g pane-border-status 'top'

# Start window indexing at...
set -g base-index 0

# Escape == copy mode
bind-key '`' copy-mode

# VI keys for tmux copy mode
set-option -g status-keys vi
set-window-option -g mode-keys vi

# Copy Mode VI Keys
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'V' send -X rectangle-toggle
unbind   -T copy-mode-vi MouseDragEnd1Pane

# Linux System Clipboard
if-shell "[ -x \"$(which xclip)\" ]" \ "
    bind-key -T copy-mode-vi 'y' send -X copy-pipe 'xclip -i -selection clipboard'; \
    bind-key -T copy-mode-vi 'MouseDragEnd1Pane' send -X copy-pipe 'xclip -i -selection clipboard'; \
"

# Don't Unselect on copy
#    bind-key -T copy-mode-vi 'y' send -X copy-pipe 'xclip -i -selection clipboard' \; send-keys -X clear-selection; \
#    bind-key -T copy-mode-vi 'MouseDragEnd1Pane' send -X copy-pipe 'xclip -i -selection clipboard' \; send-keys -X clear-selection; \

#bind-key -T copy-mode y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy" \; send-keys -X clear-selection
#bind-key -T copy-mode Y send-keys -X copy-pipe-and-cancel "tmux paste-buffer"
#bind-key -T copy-mode-vi y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy" \; send-keys -X clear-selection
#bind-key -T copy-mode-vi Y send-keys -X copy-pipe-and-cancel "tmux paste-buffer"
#unbind   -T copy-mode MouseDragEnd1Pane
#unbind   -T copy-mode-vi MouseDragEnd1Pane

# Mac System Clipboard
if-shell "[ -x \"$(which pbcopy)\" ]" \ "
    bind-key -T copy-mode-vi 'y' send -X copy-pipe 'pbcopy'; \
    bind-key -T copy-mode-vi 'MouseDragEnd1Pane' send -X copy-pipe 'pbcopy'; \
"

# Set default terminal
set -g default-terminal "screen-256color"

# Status bar settings adapted from powerline
set -g status on
set -g status-interval 10
set -g status-fg colour231
set -g status-bg colour234
set -g status-left-length 20
set -g status-left '#{?client_prefix,#[fg=colour254]#[bg=colour24]#[bold],#[fg=colour16]#[bg=colour254]#[bold]} #S #{?client_prefix,#[fg=colour24]#[bg=colour234]#[nobold],#[fg=colour254]#[bg=colour234]#[nobold]}'
set -g status-right '#(eval cut -c3- ~/.tmux.conf | sh -s status_right) #h '
set -g status-right-length 150
set -g window-status-format "#[fg=colour244,bg=colour234]#I #[fg=colour240] #[default]#W "
set -g window-status-current-format "#[fg=colour234,bg=colour24]#[fg=colour117,bg=colour24] #I  #[fg=colour231,bold]#W #[fg=colour24,bg=colour234,nobold]"
set -g window-status-last-style fg=colour24

# Default Status Bar Colors
set -g status-style fg=white,bg=blue,bright

# default window title colors
set-window-option -g window-status-style fg=white,bg=default,dim

# active window title colors
set-window-option -g window-status-current-style fg=white,bg=black,dim

# command/message line colors
set -g message-style fg=white,bg=black,bright

# Set Window Titles
set -g set-titles on
set -g set-titles-string "#h: #W/#T"

bind C-q setw synchronize-panes

#urxvt tab like window switching (-n: no prior escape seq)
bind -n S-down new-window
bind -n S-left prev
bind -n S-right next
bind -n C-left swap-window -t -1
bind -n C-right swap-window -t +1

# Pane moving
bind -n M-y swap-window -t -1\; prev
bind -n M-u prev
bind -n M-i next
bind -n M-o swap-window -t +1\; next

#new-session -s main

# " windowlist -b
unbind C-t
bind C-t choose-window
unbind t
bind t choose-window

set -g status-left-length 52
set -g status-right-length 451
set -g status-style fg=white,bg=colour234
set -g window-status-activity-style bold
#set -g pane-border-style fg=colour245
#set -g pane-active-border-style fg=colour39
set -g message-style fg=colour16,bg=colour221,bold
set -g window-status-format "#[fg=white,bg=colour234] #I #W "

# http://stackoverflow.com/questions/16618992/cant-paste-into-macvim
#set-option -g default-command "reattach-to-user-namespace -l zsh"
#

# Increase scrollback buffers
set-option -g history-limit 10000

# Mouse settings
set-option -g mouse on

# Plugins
set -g @plugin 'nhdaly/tmux-better-mouse-mode'
#set -g @plugin 'tmux-plugins/tmux-resurrect'
#set -g @plugin 'tmux-plugins/tmux-continuum'

#set -g @resurrect-strategy-nvim 'session'
#set -g @continuum-restore 'on'


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'

